<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="/YatsulevichVV/css/style.css">
    <script>
        fetch('/YatsulevichVV/head.html')
            .then(response => response.text())
            .then(data => document.head.innerHTML += data);
    </script>

    <script src="/YatsulevichVV/js/header.js"></script>
    <script src="/YatsulevichVV/js/footer.js"></script>
    <script src="/YatsulevichVV/js/table_of_content.js"></script>
    <script src="/YatsulevichVV/js/mobile.js"></script>
    <script src="/YatsulevichVV/js/latex.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> 
</head>
<body>
    
    <!-- Mobile version -->
    <table-of-content class="tc_mobile"></table-of-content>
    
    <!-- Desktop version -->
    <header-component></header-component>
    <div class="row" id="main_body" onclick="TableOfContentClose()">
        <table-of-content class="tc_desktop"></table-of-content>
        <div class="main_content">
            <div class="abstract">
                <h1>Математические основы квантовой оптимизации</h1><h2>Оптимизационные модели</h2><h3>Бинарные квадратичные модели (BQM)</h3><div class="sentence">
                    Бинарные квадратичные модели (Binary Quadratic Model)  &mdash; класс моделей основанный на двух фундаментальных классах: модель Изинга и модель QUBO (Quadratic Unconstrained Binary Optimization). Начнём с описания каждой из этих моделей.
                    </div>
                    <div class="sentence">
                        <br>
                    <b>Модель Изинга</b> используется в статистической механике. Рассмотрим два состояния $\ket{\uparrow}$ и $\ket{\downarrow}$, которым будут соответствовать собственные значения $+1$ и $-1$. Будем рассматривать связи спинов, которые описываются либо корреляцией, либо антикорреляцией. Гамильтониан такой системы можно описать с помощью равенства:
                    </div>
                    <div class="sentence">
                    \[
                        H(\mathbf{s}) = \sum_{i=1}^Nh_i s_i + \sum_{i = 1}^N\sum_{j = i + 1}^N J_{ij}s_i s_j,
                    \]
                    где $N$ &mdash; кол-во частиц, $\mathbf{s} = \{s_i\}_{i=1}^N$, $s_i \in \{-1, +1\}$, $J_{ij}$ &mdash; коэффициент взаимодействия $i$-ой и $j$-ой частицы, $h_i$ &mdash; коэффициент внешнего поля на $i$-ю частицу. Задача заклюается в отыскивании минимального значения энергии.
                    </div>
                    <div class="sentence"><br>
                    <b>QUBO модель</b> очень похожа на модель Изинга. Только модель Изинга появляется в статистической механике, а модель QUBO изначально чисто математическая задача. Пусть задана верхнетреугольная матрица $Q$ размерности $N \times N$ с вещественными коэффициентами и бинарный вектор $\mathbf{x} = \{x_i\}_{i=1}^N$, $ч_i \in \{0, 1\}$. Рассмотрим целевую функцию 
                    </div>
                    <div class="sentence">
                    \[
                        f(\mathbf{x}) = \sum_{i}Q_{ii}x_i + \sum_{i < j}Q_{ij}x_ix_j.
                    \]
                    Задача заключается в минимизации целевой функции $f(\mathbf{x})$. Эту задачу можно переписать в более простой форме
                    \[
                        \min_{\mathbf{x} \in \{0, 1\}^n}\mathbf{x}^T Q\mathbf{x}.
                    \]
                    </div>
                    <h3>Квадратичные модели с ограничениями (CQM)</h3><div class="sentence">
                    Квадратичные модели c ограничениями (Constrained Quadratic Model). Необходимо минимизировать функционал 
                    </div>
                    <div class="sentence">
                    \[
                        \sum_{i}a_ix_i + \sum_{i \leqslant j} b_{ij}x_ix_j + c,
                    \]
                    с заданными ограничениями
                    </div>
                    <div class="sentence">
                    \[
                        \sum_{i}a_i^{(m)}x_i + \sum_{i \leqslant j} b_{ij}^{(m)}x_ix_j + c^{(m)} \circ 0, \quad m = 1, \dots, M,
                    \]
                    где $\{x_i\}_{i=1,\dots,N}$ могут быть бинарными, целыми или вещественными переменными, $a_i, b_{ij}, c$ &mdash; вещественные значения, $\circ \in \{\geqslant, \leqslant, =\}$, $M$ &mdash; кол-во ограничений.
                    </div>
                    <div class="sentence">
                    Рассмотрим более детально каким именно образом можно свести модель с линейнысм ограничениями к бинарной модели. Для начала определим условия для равенства. Пусть задано ограничение вида
                    </div>
                    <div class="sentence">
                    \[
                        x_1 + x_2 + x_3 = 1.
                    \]
                    Для добавления этого условия к целевой функции необходимо представить ограничение в квадратичной форме.
                    </div>
                    <div class="sentence">
                    \[
                        \lambda(x_1 + x_2 + x_3 - 1)^2 = 0.
                    \]
                    </div>
                    <div class="sentence">
                    Если дано линейное ограничение общего вида
                    </div>
                    <div class="sentence">
                    \[
                        P(\mathbf{x}) = \sum_{i}a_ix_i - b = 0,
                    \]
                    то для добавления его к целевой функции нужно сделать следующее
                    \[
                        \lambda\left(\sum_{i}a_ix_i - b\right)^2 \equiv \lambda P(\mathbf{x})^2.
                    \]
                    </div>
                    <div class="sentence">
                    Далее рассмотрим пример с неравенством. Пусть задано неравенство с тремя двоичными переменными
                    </div>
                    <div class="sentence">
                    \[
                        x_1 + x_2 + x_3 \leqslant 2,
                    \]
                    поскольку мы сейчас рассматриваем только двоичные переменные, то мы можем от неравенства перейти к равенству. А затем использовать метод, описанный ранее. Для перехода к равенству нужно добавить две бинарные переменные $y_1$ и $y_2$.
                    </div>
                    <div class="sentence">
                    \[
                        x_1 + x_2 + x_3 = 2 - y_1 - y_2.
                    \]
                    Здесь стоит добавить некоторое пояснение. Выражение &laquo;сумма меньше либо равна двух&raquo; на множестве двоичных цифр означает &laquo;сумма равна 2 или равна 1 или равна 0&raquo;. Соответственно, первый исход достигается при $y_1 = y_2 = 1$, второй &mdash; при $y_1 = 0, y_2 = 1$ или $y_1 = 1, y_2 = 0$, а третий при $y_1=y_2=0$. 
                    </div>
                    <div class="sentence">
                    После этого достаточно добавить ограничение к целевой функции, как это было показано ранее
                    \[
                        \lambda(x_1 + x_2 + x_3 + y_1 + y_2 - 2)^2.
                    \]
                    </div>
                    <div class="sentence">
                    В более общем случае линейное ограничение в виде неравенства
                    \[
                        P(\mathbf{x}) = \sum_{i} a_ix_i - b \leqslant 0
                    \]
                    с положительными целыми коэффициентами $a_i, b$ может быть добавлено к целевой функции через добавление дополнительного слагаемого вида
                    \[
                        \lambda\left(\sum_{i}a_ix_i + \sum_{j = 1}^W w_j y_j - b \right)^2 \equiv \lambda P(\mathbf{x})^2.
                    \]
                    Число переменных $W$ и их коэффициенты $w_i$ могут быть определены через коэффициенты $a_i$ и $b$. Чаще всего $W = b$. 
                    </div>
                    <div class="sentence">
                    В описанном решении нужно было, чтобы коэффициенты $a_i, b$ были положительными и целыми. Если снять одно из ограничений, и допустить, что они могут быть отрицательными, то количество переменных возрастает до 
                    </div>
                    <div class="sentence">
                    \[
                        W = b + \sum_{a_i < 0}|a_i| 
                    \]
                    в худшем случае.
                    </div>
                    <div class="sentence">
                    По итогу полная целевая функция модели QUBO с ограничениями будет иметь вид
                    </div>
                    <div class="sentence">
                    \[
                        C(\mathbf{x}) = f(\mathbf{x}) + \sum_{k}\lambda_k P_k(\mathbf{x})^2
                    \]
                    </div>
                    
                    <h3>Дискретные квадратичные модели (DQM)</h3><div class="sentence">
                    Дискретные квадратичные модели (DQM) &mdash; полином некоторой дискретной переменной степени не превышающей двух. Дискретная переменная описывается некоторой коллекцией. Например $\{x, y, z\}$ или $\{1, 9, 0.5\}$, которые можно назвать классами. Целевой функционал определяется следующим образом:
                    </div>
                    <div class="sentence">
                    \[
                        H(\mathbf{d}) = \sum_{i}a_i(d_i) + \sum_{i, j}b_{ij}(d_i, d_j) + c,
                    \]
                    где $d_i$ &mdash; дискретная переменная, $a_i$ и $b_{ij}$ &mdash; вещественнозначные функции, $c$ &mdash; смещение. 
                    </div>
                    <div class="sentence">
                    Любую дискретную модель можно свести к бинарной модели. Пусть $D$ &mdash; это множество всевозможных классов. То есть $d_i \in D$. Тогда мы можем произвести кодирование категориального признака с помощью One-hot Encoding. А именно, каждому категориальному значению $d$ поставим в соответствие бинарный вектор $\mathbf{x}$, который содержит только одно истинное значение, то есть 
                    </div>
                    <div class="sentence">
                    \[
                        \sum_{a}x_{ia} = 1 \quad \forall i.
                    \]
                    </div>
                    <div class="sentence">
                    Пусть дискретная модель содержит $N$ дискретных переменных $d_i$, каждая из которых содержит $n_i$ классов. Тогда закодируем переменную $d_i$ бинарной переменной $x_{iu}$, которая показывает принадлежит ли переменная $d_i$ классу $u$. В таком случае целевой функционал можно переписать в виде
                    </div>
                    <div class="sentence">
                    \[
                        E(\mathbf{x}) = \sum_{i=1}^N\sum_{u=1}^{n_i}a_{iu}x_{iu} + \sum_{i=1}^N\sum_{j=i+1}^N\sum_{u=1}^{n_i}\sum_{v=1}^{n_j}b_{ijuv}x_{iu}x_{jv}.
                    \]
                    </div>
                    <h2>Примеры задач</h2><h3>MaxCut</h3><div class="sentence">
                    Пусть задан неориентированный граф $G = (V, E)$. Необходимо найти подмножество вершин $W \subset V$, такое что количество рёбер между подмножеством $W$ и его дополнением $\overline{W}$ было максимальным.
                    </div>
                    <div class="sentence">
                    Задачу можно переформулировать следующим образом. Определить множество вершин $W$ &mdash; это тоже самое, что определить какие вершины принадлежат этому множеству, а какие нет. То есть каждой вершине $v_i$ можно поставить в соответствие бинарную переменную $x_i$, которая равна $1$, если вершина будет принадлежать множеству $W$ и $0$ в противном случае.
                    </div>
                    <div class="sentence">
                    Теперь нужно определить целевую функцию $f(x_1, x_2, \dots x_{n})$, где $n = |V|$, которая бы решала исходную задачу. Необходимо максимизировать количество рёбер, у которых концевые вершины принадлежат разным классам (то есть $x_i \neq x_j$). 
                    </div>
                    <div class="sentence">
                    \[
                        f(x_i, x_j) = x_i \oplus x_j.
                    \]
                    Такая функция будет давать $0$, если классы одинаковые и $1$, если классы разные. Представим XOR в виде произведения и суммы, тогда получим 
                    </div>
                    <div class="sentence">
                    \[
                        f(x_i, x_j) = x_i + x_j - 2x_ix_j.
                    \]
                    </div>
                    <div class="sentence">
                    Тогда задача поиска максимального разреза сведётся к следующей оптимизационной задаче
                    </div>
                    <div class="sentence">
                    \[
                        \max \sum_{(i, j)\in E}(x_i + x_j - 2x_ix_j),
                    \]
                    или что соответствует задаче минимазации
                    \[
                        \min \sum_{(i, j)\in E}(-x_i - x_j + 2x_ix_j).
                    \]
                    
                    </div>
                    
                    
            </div>
        </div>
    </div>
    <footer-component></footer-component>
</body>
<!-- -->